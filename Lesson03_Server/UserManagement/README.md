# ユーザー管理

ここではLinuxでのユーザー管理について紹介します。

## ■ 管理者ユーザーと一般ユーザー

Linuxでは、通常の作業を一般ユーザーで行い、管理者権限が必要な作業をrootユーザーで作業します。  
常にrootユーザーで作業するとちょっとしたミスがシステムに膨大な被害を与えてしまう恐れがあるからです。  
現在どのユーザーが作業しているのかはプロンプトを見ればわかります。

- rootユーザー

    ``` shell
    [root@centos7 ~]#
    ```

- 一般ユーザー

    ``` shell
    [centuser@centos7 ~]$
    ```

rootユーザーの場合はプロンプトの末尾が「`#`」になり、一般ユーザーのプロンプトの末尾は「`$`」シェルによっては「`%`」になります。  
どのシェルもrootユーザーは共通していますので、常に今どのユーザーが作業しているのか注意を払ってください。

## ■ su コマンド

`su` コマンドを使うと、ログイン中に別のユーザーに切り替える事ができます。

- 書式  
    `su [-] ユーザー名`

ユーザー名を指定すると、そのユーザーに切り替わります。省略するとrootユーザーになります。

オプション「`-`」を指定すると、ユーザー環境は新規にログインした時と同じ状態になる。  
「`-`」をつけない場合、管理者コマンドが使えない問題が生じるので、つけて実行するといいでしょう。  
作業が終了したら`exit` コマンドで元のユーザーに戻ってください。  
`su - 元のユーザー` で戻ったつもりにならないでください。

## ■ sudo コマンド

`su` コマンドによるrootユーザーの切り替えは好ましくありません。  
管理者権限が必要なユーザー全てにパスワードを教えないと行けない為リスクも大きいです。  
そこで`sudo` コマンドを使います。`sudo` コマンドを使えば、任意の管理者コマンドを、任意のユーザーに対して実行する事ができます。  
その際、パスワードも求められないのもメリットの一つです。

`sudo` コマンドを使う前にあらかじめ設定が必要です。  
設定ファイルは`/etc/sudoers` ですが、このファイルは編集してはいけない。  
`visudo` コマンドを使って設定します。rootユーザーで`visudo` コマンドを実行するとvimで開かれます。 
指定のエディターで変更したい場合は、

``` shell
# EDITOR=nano visudo
```

開いたら最後の行に設定を加えます。

- 書式  
    `ユーザー名 ホスト名=(実行ユーザー名) 許可するコマンド`

- 例

    ``` shell
    centuser ALL=(ALL) ALL
    ```

保存すると`sudo` コマンドが使えるようになります。  
例えば、再起動の場合は、

``` shell
$ sudo shutdown -r now
```

パスワードを求められますがrootのパスワードではない点に注意してください。  

また、`sudo` を実行すると記録が残され、`/var/log/secure` でログを確認する事ができます。

``` shell
# less /var/log/secure
```

<a href="../../README.md">戻る➡︎</a>
